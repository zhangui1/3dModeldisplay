# ğŸš€ å®å¡”é¢æ¿éƒ¨ç½²æŒ‡å— - 3D æ¨¡å‹å±•ç¤ºå¹³å°

## ğŸ“‹ ç›®å½•
1. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
2. [ä¸Šä¼ é¡¹ç›®æ–‡ä»¶](#ä¸Šä¼ é¡¹ç›®æ–‡ä»¶)
3. [å®‰è£… Node.js ç¯å¢ƒ](#å®‰è£…-nodejs-ç¯å¢ƒ)
4. [åˆ›å»ºç½‘ç«™é…ç½®](#åˆ›å»ºç½‘ç«™é…ç½®)
5. [å…³é”®é…ç½®ä¿®æ”¹](#å…³é”®é…ç½®ä¿®æ”¹)
6. [å¯åŠ¨ Node.js åº”ç”¨](#å¯åŠ¨-nodejs-åº”ç”¨)
7. [æµ‹è¯•éªŒè¯](#æµ‹è¯•éªŒè¯)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç¯å¢ƒå‡†å¤‡

### 1ï¸âƒ£ ç™»å½•å®å¡”é¢æ¿

è®¿é—®ï¼š`http://ä½ çš„æœåŠ¡å™¨IP:8888`

è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ç™»å½•

### 2ï¸âƒ£ å®‰è£…å¿…è¦è½¯ä»¶

åœ¨å®å¡”é¢æ¿å·¦ä¾§èœå• â†’ **è½¯ä»¶å•†åº—**ï¼Œå®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š

- âœ… **Nginx 1.20+**ï¼ˆå¿…é¡»ï¼‰
- âœ… **PM2 ç®¡ç†å™¨**ï¼ˆå¿…é¡»ï¼Œç”¨äºç®¡ç† Node.js åº”ç”¨ï¼‰
- âœ… **Node ç‰ˆæœ¬ç®¡ç†å™¨**ï¼ˆæ¨èå®‰è£… Node.js 18.x æˆ– 20.xï¼‰

**å®‰è£…æ­¥éª¤ï¼š**
1. ç‚¹å‡» "è½¯ä»¶å•†åº—"
2. æœç´¢ "Nginx" â†’ ç‚¹å‡» "å®‰è£…"
3. æœç´¢ "PM2" â†’ ç‚¹å‡» "å®‰è£…"
4. æœç´¢ "Node ç‰ˆæœ¬ç®¡ç†å™¨" â†’ ç‚¹å‡» "å®‰è£…"

---

## ä¸Šä¼ é¡¹ç›®æ–‡ä»¶

### æ–¹å¼ Aï¼šä½¿ç”¨å®å¡”æ–‡ä»¶ç®¡ç†å™¨ä¸Šä¼ 

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **æ–‡ä»¶**
2. è¿›å…¥ç›®å½•ï¼š`/www/wwwroot/`
3. ç‚¹å‡» "ä¸Šä¼ " æŒ‰é’®
4. ä¸Šä¼ ä½ çš„é¡¹ç›®å‹ç¼©åŒ…ï¼ˆzip æˆ– tar.gzï¼‰
5. å³é”®ç‚¹å‡»å‹ç¼©åŒ… â†’ "è§£å‹"
6. è§£å‹åä¼šå¾—åˆ° `3dModeldisplay` æ–‡ä»¶å¤¹

### æ–¹å¼ Bï¼šä½¿ç”¨ Git å…‹éš†ï¼ˆæ¨èï¼‰

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **æ–‡ä»¶**
2. è¿›å…¥ç›®å½•ï¼š`/www/wwwroot/`
3. ç‚¹å‡» "ç»ˆç«¯" æŒ‰é’®
4. æ‰§è¡Œå‘½ä»¤ï¼š
```bash
cd /www/wwwroot/
git clone https://github.com/ä½ çš„ä»“åº“åœ°å€/3dModeldisplay.git
```

### éªŒè¯é¡¹ç›®ç»“æ„

ç¡®ä¿é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š
```
/www/wwwroot/3dModeldisplay/
â”œâ”€â”€ server.js
â”œâ”€â”€ package.json
â”œâ”€â”€ data/
â”‚   â””â”€â”€ models.json
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ css/
â”‚   â””â”€â”€ js/
â””â”€â”€ admin/
```

---

## å®‰è£… Node.js ç¯å¢ƒ

### 1ï¸âƒ£ å®‰è£…é¡¹ç›®ä¾èµ–

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **æ–‡ä»¶**
2. è¿›å…¥ `/www/wwwroot/3dModeldisplay/`
3. ç‚¹å‡» "ç»ˆç«¯" æŒ‰é’®
4. æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# ç¡®è®¤å½“å‰åœ¨é¡¹ç›®ç›®å½•
pwd
# åº”è¯¥æ˜¾ç¤ºï¼š/www/wwwroot/3dModeldisplay

# å®‰è£…ä¾èµ–
npm install

# å¦‚æœé€Ÿåº¦æ…¢ï¼Œä½¿ç”¨å›½å†…é•œåƒ
npm install --registry=https://registry.npmmirror.com
```

### 2ï¸âƒ£ æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…æˆåŠŸ

```bash
# æ£€æŸ¥ node_modules æ–‡ä»¶å¤¹
ls -la
# åº”è¯¥èƒ½çœ‹åˆ° node_modules æ–‡ä»¶å¤¹

# æŸ¥çœ‹å®‰è£…çš„åŒ…
npm list --depth=0
```

---

## åˆ›å»ºç½‘ç«™é…ç½®

### 1ï¸âƒ£ æ·»åŠ ç«™ç‚¹

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **ç½‘ç«™**
2. ç‚¹å‡» "æ·»åŠ ç«™ç‚¹" æŒ‰é’®
3. å¡«å†™è¡¨å•ï¼š
   - **åŸŸå**ï¼šå¡«å†™ä½ çš„åŸŸåï¼ˆå¦‚ `example.com`ï¼‰æˆ–æœåŠ¡å™¨ IPï¼ˆå¦‚ `123.45.67.89`ï¼‰
   - **å¤‡æ³¨**ï¼š`3Dæ¨¡å‹å±•ç¤ºå¹³å°`
   - **æ ¹ç›®å½•**ï¼š`/www/wwwroot/3dModeldisplay/public`
   - **FTP**ï¼šä¸åˆ›å»º
   - **æ•°æ®åº“**ï¼šä¸åˆ›å»º
   - **PHP ç‰ˆæœ¬**ï¼šçº¯é™æ€
4. ç‚¹å‡» "æäº¤"

### 2ï¸âƒ£ ä¿®æ”¹ç«™ç‚¹é…ç½®

æ·»åŠ å®Œæˆåï¼Œåœ¨ç½‘ç«™åˆ—è¡¨ä¸­æ‰¾åˆ°åˆšåˆ›å»ºçš„ç«™ç‚¹ï¼š

1. ç‚¹å‡»ç«™ç‚¹åç§°å³ä¾§çš„ "è®¾ç½®" æŒ‰é’®
2. è¿›å…¥ç«™ç‚¹è®¾ç½®é¡µé¢

---

## å…³é”®é…ç½®ä¿®æ”¹

### ğŸ”§ æ­¥éª¤ 1ï¼šä¿®æ”¹ Nginx é…ç½®æ–‡ä»¶

åœ¨ç«™ç‚¹è®¾ç½®é¡µé¢ï¼š

1. ç‚¹å‡»å·¦ä¾§ **"é…ç½®æ–‡ä»¶"** æ ‡ç­¾
2. æ¸…ç©ºç°æœ‰å†…å®¹
3. ç²˜è´´ä»¥ä¸‹å®Œæ•´é…ç½®ï¼š

```nginx
server {
    listen 80;
    listen [::]:80;
    
    # ä¿®æ”¹ä¸ºä½ çš„åŸŸåæˆ– IP
    server_name 123.45.67.89;  # â† ä¿®æ”¹è¿™é‡Œï¼
    
    # æ—¥å¿—æ–‡ä»¶
    access_log /www/wwwroot/3dModeldisplay/logs/access.log;
    error_log /www/wwwroot/3dModeldisplay/logs/error.log;
    
    # ========================================
    # é‡è¦ï¼æ–‡ä»¶ä¸Šä¼ å’Œè¶…æ—¶é…ç½®
    # ========================================
    
    # å…è®¸ä¸Šä¼ å¤§æ–‡ä»¶ï¼ˆæ”¯æŒå¤§å‹ 3D æ¨¡å‹ï¼‰
    client_max_body_size 500M;
    
    # å¢åŠ è¶…æ—¶æ—¶é—´
    client_body_timeout 600s;
    client_header_timeout 600s;
    send_timeout 600s;
    
    # å¢åŠ ç¼“å†²åŒº
    client_body_buffer_size 128k;
    
    # ========================================
    # æ ¸å¿ƒé…ç½® 1ï¼šæ¨¡å‹æ–‡ä»¶æœåŠ¡ï¼ˆæ”¯æŒ Range è¯·æ±‚ï¼‰
    # ========================================
    
    location /models/ {
        # æŒ‡å‘å®é™…çš„æ¨¡å‹æ–‡ä»¶ç›®å½•
        alias /www/wwwroot/3dModeldisplay/public/models/;
        
        # âœ… å…³é”®ï¼å¯ç”¨ Range è¯·æ±‚æ”¯æŒï¼ˆæ¸è¿›å¼åŠ è½½å¿…éœ€ï¼‰
        add_header Accept-Ranges bytes always;
        
        # âœ… CORS è·¨åŸŸé…ç½®ï¼ˆå¿…éœ€ï¼‰
        add_header Access-Control-Allow-Origin * always;
        add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS" always;
        add_header Access-Control-Allow-Headers "Range, Content-Type, Accept, Origin" always;
        add_header Access-Control-Expose-Headers "Accept-Ranges, Content-Length, Content-Range, Content-Type" always;
        
        # å¤„ç† OPTIONS é¢„æ£€è¯·æ±‚
        if ($request_method = 'OPTIONS') {
            add_header Access-Control-Allow-Origin * always;
            add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS" always;
            add_header Access-Control-Allow-Headers "Range, Content-Type, Accept, Origin" always;
            add_header Access-Control-Max-Age 1728000;
            add_header Content-Type 'text/plain; charset=utf-8';
            add_header Content-Length 0;
            return 204;
        }
        
        # âœ… è®¾ç½®æ­£ç¡®çš„ MIME ç±»å‹ï¼ˆé‡è¦ï¼‰
        types {
            application/octet-stream    ply;     # PLY ç‚¹äº‘
            model/obj                   obj;     # OBJ æ¨¡å‹
            application/octet-stream    stl;     # STL æ¨¡å‹
            model/gltf-binary          glb;     # GLBï¼ˆé¢„ç•™ï¼‰
            model/gltf+json            gltf;    # GLTFï¼ˆé¢„ç•™ï¼‰
        }
        default_type application/octet-stream;
        
        # ç¦ç”¨ gzipï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶æ— éœ€å‹ç¼©ï¼‰
        gzip off;
        
        # å¯ç”¨ç¼“å­˜
        expires 30d;
        add_header Cache-Control "public, immutable" always;
        
        # æ€§èƒ½ä¼˜åŒ–
        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
    }
    
    # ========================================
    # æ ¸å¿ƒé…ç½® 2ï¼šç¼©ç•¥å›¾æœåŠ¡
    # ========================================
    
    location /images/ {
        alias /www/wwwroot/3dModeldisplay/public/images/;
        
        # CORS é…ç½®
        add_header Access-Control-Allow-Origin * always;
        
        # ç¼“å­˜é…ç½®
        expires 30d;
        add_header Cache-Control "public" always;
        
        # å›¾ç‰‡å‹ç¼©
        gzip on;
        gzip_types image/svg+xml;
    }
    
    # ========================================
    # æ ¸å¿ƒé…ç½® 3ï¼šCSS/JS é™æ€èµ„æº
    # ========================================
    
    location /css/ {
        alias /www/wwwroot/3dModeldisplay/public/css/;
        expires 7d;
        add_header Cache-Control "public" always;
        gzip on;
    }
    
    location /js/ {
        alias /www/wwwroot/3dModeldisplay/public/js/;
        expires 7d;
        add_header Cache-Control "public" always;
        gzip on;
        gzip_types application/javascript text/javascript;
    }
    
    # ========================================
    # æ ¸å¿ƒé…ç½® 4ï¼šç®¡ç†åå°ï¼ˆæ”¯æŒå¤§æ–‡ä»¶ä¸Šä¼ ï¼‰
    # ========================================
    
    location /admin/ {
        proxy_pass http://127.0.0.1:3000/admin/;
        proxy_http_version 1.1;
        
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        
        # ä¸Šä¼ å¤§æ–‡ä»¶è¶…æ—¶é…ç½®
        proxy_connect_timeout 600s;
        proxy_send_timeout 600s;
        proxy_read_timeout 600s;
        
        # ç¦ç”¨ç¼“å†²ï¼ˆå¤§æ–‡ä»¶ä¸Šä¼ å¿…éœ€ï¼‰
        proxy_request_buffering off;
    }
    
    # ========================================
    # æ ¸å¿ƒé…ç½® 5ï¼šAPI è·¯ç”±
    # ========================================
    
    location /api/ {
        proxy_pass http://127.0.0.1:3000/api/;
        proxy_http_version 1.1;
        
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        
        # ä¸Šä¼ è¶…æ—¶é…ç½®
        proxy_connect_timeout 600s;
        proxy_send_timeout 600s;
        proxy_read_timeout 600s;
        
        # å¤§æ–‡ä»¶ä¸Šä¼ 
        proxy_request_buffering off;
    }
    
    # ========================================
    # æ ¸å¿ƒé…ç½® 6ï¼šé»˜è®¤è·¯ç”±ï¼ˆä»£ç†åˆ° Node.jsï¼‰
    # ========================================
    
    location / {
        # ä»£ç†åˆ° Node.js åº”ç”¨
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        
        # æ ‡å‡†ä»£ç†å¤´
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # âœ… ä¼ é€’ Range è¯·æ±‚å¤´ï¼ˆé‡è¦ï¼‰
        proxy_set_header Range $http_range;
        proxy_set_header If-Range $http_if_range;
        
        # ç¦ç”¨ä»£ç†ç¼“å†²
        proxy_buffering off;
        proxy_request_buffering off;
        
        # ç¦ç”¨ Range è¯·æ±‚ç¼“å­˜
        proxy_no_cache $http_range $http_if_range;
        proxy_cache_bypass $http_upgrade;
        
        # è¶…æ—¶é…ç½®
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }
    
    # ========================================
    # é”™è¯¯é¡µé¢
    # ========================================
    
    error_page 404 /404.html;
    error_page 502 /502.html;
}
```

4. **é‡è¦ï¼ä¿®æ”¹ç¬¬ 7 è¡Œçš„ `server_name`**ï¼š
   - å¦‚æœæœ‰åŸŸåï¼šæ”¹ä¸º `server_name example.com www.example.com;`
   - å¦‚æœåªæœ‰ IPï¼šæ”¹ä¸º `server_name 123.45.67.89;`

5. ç‚¹å‡» "ä¿å­˜" æŒ‰é’®

### ğŸ”§ æ­¥éª¤ 2ï¼šåˆ›å»ºæ—¥å¿—ç›®å½•

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **æ–‡ä»¶**
2. è¿›å…¥ `/www/wwwroot/3dModeldisplay/`
3. ç‚¹å‡» "æ–°å»ºç›®å½•" æŒ‰é’®
4. è¾“å…¥ç›®å½•åï¼š`logs`
5. ç‚¹å‡» "ç¡®å®š"

### ğŸ”§ æ­¥éª¤ 3ï¼šè®¾ç½®ç›®å½•æƒé™

1. åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­ï¼Œå³é”®ç‚¹å‡» `3dModeldisplay` æ–‡ä»¶å¤¹
2. é€‰æ‹© "æƒé™"
3. è®¾ç½®ä¸º `755`
4. **å‹¾é€‰** "åº”ç”¨åˆ°å­ç›®å½•"
5. ç‚¹å‡» "ç¡®å®š"

æˆ–ä½¿ç”¨ç»ˆç«¯å‘½ä»¤ï¼š
```bash
cd /www/wwwroot/
chmod -R 755 3dModeldisplay/
```

---

## å¯åŠ¨ Node.js åº”ç”¨

### æ–¹å¼ Aï¼šä½¿ç”¨ PM2 ç®¡ç†å™¨ï¼ˆæ¨èï¼‰

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **è½¯ä»¶å•†åº—**
2. æ‰¾åˆ° "PM2 ç®¡ç†å™¨"
3. ç‚¹å‡» "è®¾ç½®"
4. ç‚¹å‡» "æ·»åŠ é¡¹ç›®"
5. å¡«å†™è¡¨å•ï¼š
   - **é¡¹ç›®åç§°**ï¼š`3d-model-display`
   - **å¯åŠ¨æ–‡ä»¶**ï¼šé€‰æ‹© `/www/wwwroot/3dModeldisplay/server.js`
   - **è¿è¡Œç›®å½•**ï¼š`/www/wwwroot/3dModeldisplay`
   - **ç«¯å£**ï¼š`3000`
   - **å¯åŠ¨å‘½ä»¤**ï¼šé»˜è®¤å³å¯
6. ç‚¹å‡» "æäº¤"

### æ–¹å¼ Bï¼šä½¿ç”¨ç»ˆç«¯å‘½ä»¤

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **æ–‡ä»¶**
2. è¿›å…¥ `/www/wwwroot/3dModeldisplay/`
3. ç‚¹å‡» "ç»ˆç«¯"
4. æ‰§è¡Œå‘½ä»¤ï¼š

```bash
# ä½¿ç”¨ PM2 å¯åŠ¨
pm2 start server.js --name "3d-model-display"

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs 3d-model-display
```

### éªŒè¯åº”ç”¨å¯åŠ¨

```bash
# æ£€æŸ¥ç«¯å£ 3000 æ˜¯å¦è¢«ç›‘å¬
netstat -tlnp | grep 3000

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
# tcp6  0  0  :::3000  :::*  LISTEN  12345/node
```

---

## æµ‹è¯•éªŒè¯

### âœ… æ­¥éª¤ 1ï¼šæµ‹è¯•åŸºæœ¬è®¿é—®

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://ä½ çš„IPæˆ–åŸŸå/`

åº”è¯¥èƒ½çœ‹åˆ° 3D æ¨¡å‹å±•ç¤ºé¡µé¢

### âœ… æ­¥éª¤ 2ï¼šæµ‹è¯•ç®¡ç†åå°

è®¿é—®ï¼š`http://ä½ çš„IPæˆ–åŸŸå/admin/index.html`

åº”è¯¥èƒ½çœ‹åˆ°ç®¡ç†åå°ç•Œé¢

### âœ… æ­¥éª¤ 3ï¼šæµ‹è¯• Range è¯·æ±‚æ”¯æŒï¼ˆå…³é”®ï¼ï¼‰

#### åœ¨å®å¡”é¢æ¿ä¸­æµ‹è¯•

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **æ–‡ä»¶**
2. è¿›å…¥ `/www/wwwroot/3dModeldisplay/public/models/`
3. æ‰¾åˆ°ä¸€ä¸ª `.ply` æ–‡ä»¶åï¼Œä¾‹å¦‚ï¼š`modelFile-1759066178650-649551307.ply`
4. ç‚¹å‡»å·¦ä¾§èœå• â†’ **æ–‡ä»¶** â†’ **ç»ˆç«¯**
5. æ‰§è¡Œæµ‹è¯•å‘½ä»¤ï¼š

```bash
# æµ‹è¯• Range è¯·æ±‚ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®é™…æ–‡ä»¶åï¼‰
curl -I -H "Range: bytes=0-1023" http://127.0.0.1/models/modelFile-ä½ çš„æ–‡ä»¶å.ply

# âœ… æ­£ç¡®çš„å“åº”åº”è¯¥åŒ…å«ï¼š
# HTTP/1.1 206 Partial Content
# Accept-Ranges: bytes
# Content-Range: bytes 0-1023/æ€»å¤§å°
# Access-Control-Allow-Origin: *

# âŒ å¦‚æœçœ‹åˆ° HTTP/1.1 200 OKï¼Œè¯´æ˜ Range è¯·æ±‚æœªç”Ÿæ•ˆ
```

#### åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•

1. è®¿é—®æ¨¡å‹å±•ç¤ºé¡µé¢
2. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ° **Networkï¼ˆç½‘ç»œï¼‰** æ ‡ç­¾é¡µ
4. ç‚¹å‡»åŠ è½½ä¸€ä¸ª PLY æ¨¡å‹
5. åœ¨ç½‘ç»œé¢æ¿ä¸­æ‰¾åˆ° PLY æ–‡ä»¶çš„è¯·æ±‚
6. ç‚¹å‡»è¯¥è¯·æ±‚ï¼ŒæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼š

**è¯·æ±‚å¤´ï¼ˆRequest Headersï¼‰åº”è¯¥åŒ…å«ï¼š**
```
Range: bytes=0-xxxxx
```

**å“åº”å¤´ï¼ˆResponse Headersï¼‰åº”è¯¥åŒ…å«ï¼š**
```
HTTP/1.1 206 Partial Content
Accept-Ranges: bytes
Content-Range: bytes 0-xxxxx/æ€»å¤§å°
Access-Control-Allow-Origin: *
```

**çŠ¶æ€ç åº”è¯¥æ˜¯ï¼š206ï¼ˆä¸æ˜¯ 200ï¼‰**

### âœ… æ­¥éª¤ 4ï¼šæµ‹è¯•æ¨¡å‹ä¸Šä¼ 

1. è®¿é—®ç®¡ç†åå°ï¼š`http://ä½ çš„IP/admin/index.html`
2. ç‚¹å‡» "ä¸Šä¼ æ¨¡å‹" æŒ‰é’®
3. å¡«å†™è¡¨å•å¹¶ä¸Šä¼ ä¸€ä¸ªæµ‹è¯•æ¨¡å‹
4. æ£€æŸ¥æ˜¯å¦ä¸Šä¼ æˆåŠŸ

### âœ… æ­¥éª¤ 5ï¼šæµ‹è¯•æ¨¡å‹åŠ è½½

1. å›åˆ°å±•ç¤ºé¡µé¢ï¼š`http://ä½ çš„IP/`
2. ç‚¹å‡»åˆšä¸Šä¼ çš„æ¨¡å‹
3. è§‚å¯ŸåŠ è½½è¿›åº¦ï¼š
   - âœ… åº”è¯¥ä» 0% â†’ 10% â†’ 50% â†’ 100% é€æ­¥å¢åŠ 
   - âœ… æ¨¡å‹åº”è¯¥èƒ½æ­£å¸¸æ˜¾ç¤º
   - âŒ å¦‚æœå¡åœ¨ 0% ä¸åŠ¨ï¼Œè¯´æ˜ Range è¯·æ±‚æœ‰é—®é¢˜

---

## å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼š502 Bad Gateway

**åŸå› **ï¼šNode.js åº”ç”¨æœªå¯åŠ¨æˆ–ç«¯å£ä¸å¯¹

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ PM2 çŠ¶æ€ï¼š`pm2 status`
2. å¦‚æœæœªè¿è¡Œï¼Œå¯åŠ¨åº”ç”¨ï¼š`pm2 start server.js --name "3d-model-display"`
3. æŸ¥çœ‹æ—¥å¿—ï¼š`pm2 logs`

### é—®é¢˜ 2ï¼š403 Forbidden

**åŸå› **ï¼šæ–‡ä»¶æƒé™ä¸è¶³

**è§£å†³æ–¹æ³•**ï¼š
```bash
cd /www/wwwroot/
chmod -R 755 3dModeldisplay/
chown -R www:www 3dModeldisplay/
```

### é—®é¢˜ 3ï¼šæ¨¡å‹åŠ è½½å¡åœ¨ 0%

**åŸå› **ï¼šRange è¯·æ±‚æœªæ­£ç¡®é…ç½®

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ Nginx é…ç½®ä¸­æ˜¯å¦æœ‰ `add_header Accept-Ranges bytes always;`
2. é‡è½½ Nginx é…ç½®ï¼ˆå®å¡”é¢æ¿ â†’ è½¯ä»¶å•†åº— â†’ Nginx â†’ é‡è½½é…ç½®ï¼‰
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡è¯•ï¼ˆCtrl+F5ï¼‰

### é—®é¢˜ 4ï¼šä¸Šä¼ å¤§æ–‡ä»¶å¤±è´¥

**åŸå› **ï¼šæ–‡ä»¶å¤§å°é™åˆ¶æˆ–è¶…æ—¶

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®è®¤ Nginx é…ç½®ä¸­æœ‰ `client_max_body_size 500M;`
2. æ£€æŸ¥å®å¡”é¢æ¿ â†’ è½¯ä»¶å•†åº— â†’ PHPï¼ˆå¦‚æœè£…äº†ï¼‰â†’ ä¸Šä¼ é™åˆ¶
3. å¢åŠ è¶…æ—¶æ—¶é—´ï¼ˆå·²åœ¨é…ç½®ä¸­è®¾ç½®ï¼‰

### é—®é¢˜ 5ï¼šCORS é”™è¯¯

**åŸå› **ï¼šè·¨åŸŸé…ç½®é—®é¢˜

**è§£å†³æ–¹æ³•**ï¼š
ç¡®ä¿ Nginx é…ç½®ä¸­ `/models/` location å—åŒ…å«ï¼š
```nginx
add_header Access-Control-Allow-Origin * always;
add_header Access-Control-Expose-Headers "Accept-Ranges, Content-Length, Content-Range" always;
```

### é—®é¢˜ 6ï¼šæ¨¡å‹æ–‡ä»¶ 404 Not Found

**åŸå› **ï¼šè·¯å¾„é…ç½®é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š
```bash
ls -la /www/wwwroot/3dModeldisplay/public/models/
```
2. ç¡®è®¤ Nginx é…ç½®ä¸­çš„ `alias` è·¯å¾„æ­£ç¡®

### é—®é¢˜ 7ï¼šç½‘ç«™æ— æ³•è®¿é—®

**åŸå› **ï¼šé˜²ç«å¢™æˆ–å®‰å…¨ç»„æœªå¼€æ”¾ç«¯å£

**è§£å†³æ–¹æ³•**ï¼š
1. å®å¡”é¢æ¿ â†’ **å®‰å…¨**
2. æ”¾è¡Œç«¯å£ï¼š`80` å’Œ `443`ï¼ˆHTTPSï¼‰
3. å¦‚æœæ˜¯äº‘æœåŠ¡å™¨ï¼Œè¿˜éœ€è¦åœ¨äº‘æœåŠ¡å•†æ§åˆ¶å°çš„å®‰å…¨ç»„ä¸­æ”¾è¡Œç«¯å£

---

## ğŸ”’ å®‰å…¨é…ç½®ï¼ˆå¯é€‰ä½†æ¨èï¼‰

### 1. å¯ç”¨ HTTPSï¼ˆå…è´¹ SSL è¯ä¹¦ï¼‰

1. åœ¨ç½‘ç«™è®¾ç½®é¡µé¢ï¼Œç‚¹å‡» **"SSL"** æ ‡ç­¾
2. é€‰æ‹© **"Let's Encrypt"**
3. è¾“å…¥ä½ çš„é‚®ç®±
4. ç‚¹å‡» "ç”³è¯·"
5. ç­‰å¾…è¯ä¹¦ç”³è¯·å®Œæˆ
6. å¼€å¯ "å¼ºåˆ¶ HTTPS"

### 2. è®¾ç½®ç®¡ç†åå°è®¿é—®å¯†ç 

åœ¨ Nginx é…ç½®ä¸­æ·»åŠ ï¼š
```nginx
location /admin/ {
    auth_basic "Admin Area";
    auth_basic_user_file /www/wwwroot/3dModeldisplay/.htpasswd;
    
    proxy_pass http://127.0.0.1:3000/admin/;
    # ... å…¶ä»–é…ç½® ...
}
```

ç„¶ååˆ›å»ºå¯†ç æ–‡ä»¶ï¼š
```bash
# å®‰è£… htpasswd å·¥å…·
yum install httpd-tools  # CentOS
apt install apache2-utils  # Ubuntu

# åˆ›å»ºå¯†ç æ–‡ä»¶
htpasswd -c /www/wwwroot/3dModeldisplay/.htpasswd admin
# è¾“å…¥å¯†ç ä¸¤æ¬¡
```

### 3. é™åˆ¶ä¸Šä¼ é€Ÿç‡ï¼ˆé˜²æ­¢æ»¥ç”¨ï¼‰

åœ¨ Nginx server å—ä¸­æ·»åŠ ï¼š
```nginx
# é™åˆ¶ä¸Šä¼ é€Ÿç‡ä¸º 10MB/s
limit_rate 10m;
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

### ä½¿ç”¨å®å¡”é¢æ¿ç›‘æ§

1. ç‚¹å‡»å·¦ä¾§èœå• â†’ **ç›‘æ§**
2. æŸ¥çœ‹ï¼š
   - CPU ä½¿ç”¨ç‡
   - å†…å­˜ä½¿ç”¨ç‡
   - ç£ç›˜ä½¿ç”¨æƒ…å†µ
   - ç½‘ç»œæµé‡

### æŸ¥çœ‹ PM2 è¿›ç¨‹çŠ¶æ€

```bash
# æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
pm2 show 3d-model-display

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
pm2 logs 3d-model-display --lines 100

# æŸ¥çœ‹ç›‘æ§
pm2 monit
```

### æŸ¥çœ‹ Nginx æ—¥å¿—

1. å®å¡”é¢æ¿ â†’ **ç½‘ç«™**
2. æ‰¾åˆ°ä½ çš„ç«™ç‚¹ï¼Œç‚¹å‡» "æ—¥å¿—"
3. æŸ¥çœ‹è®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—

æˆ–ä½¿ç”¨å‘½ä»¤ï¼š
```bash
# è®¿é—®æ—¥å¿—
tail -f /www/wwwroot/3dModeldisplay/logs/access.log

# é”™è¯¯æ—¥å¿—
tail -f /www/wwwroot/3dModeldisplay/logs/error.log
```

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹æ‰€æœ‰æ­¥éª¤åï¼Œä½ çš„ 3D æ¨¡å‹å±•ç¤ºå¹³å°å°±éƒ¨ç½²å®Œæˆäº†ï¼š

- [ ] å®‰è£… Nginxã€PM2ã€Node.js
- [ ] ä¸Šä¼ é¡¹ç›®æ–‡ä»¶åˆ° `/www/wwwroot/3dModeldisplay/`
- [ ] å®‰è£… npm ä¾èµ–ï¼ˆ`npm install`ï¼‰
- [ ] åˆ›å»ºç½‘ç«™å¹¶é…ç½® Nginx
- [ ] ä¿®æ”¹ `server_name` ä¸ºå®é™…åŸŸå/IP
- [ ] åˆ›å»º `logs` ç›®å½•
- [ ] è®¾ç½®ç›®å½•æƒé™ï¼ˆ755ï¼‰
- [ ] ä½¿ç”¨ PM2 å¯åŠ¨ Node.js åº”ç”¨
- [ ] æµ‹è¯•åŸºæœ¬è®¿é—®ï¼ˆé¦–é¡µï¼‰
- [ ] æµ‹è¯•ç®¡ç†åå°
- [ ] **æµ‹è¯• Range è¯·æ±‚ï¼ˆçŠ¶æ€ç  206ï¼‰**
- [ ] æµ‹è¯•æ¨¡å‹ä¸Šä¼ 
- [ ] æµ‹è¯•æ¨¡å‹åŠ è½½ï¼ˆ0% â†’ 100%ï¼‰
- [ ] ï¼ˆå¯é€‰ï¼‰é…ç½® SSL è¯ä¹¦
- [ ] ï¼ˆå¯é€‰ï¼‰è®¾ç½®å®šæ—¶ä»»åŠ¡å¤‡ä»½

---

## ğŸ¯ å…³é”®é…ç½®æ€»ç»“

| é…ç½®é¡¹ | ä½ç½® | ä½œç”¨ | æ˜¯å¦å¿…éœ€ |
|--------|------|------|---------|
| `Accept-Ranges: bytes` | `/models/` location | å¯ç”¨ Range è¯·æ±‚ | âœ… å¿…éœ€ |
| `Access-Control-Allow-Origin: *` | `/models/` location | è§£å†³ CORS è·¨åŸŸ | âœ… å¿…éœ€ |
| `application/octet-stream ply` | types é…ç½® | PLY æ–‡ä»¶ MIME ç±»å‹ | âœ… å¿…éœ€ |
| `client_max_body_size 500M` | server å— | å…è®¸å¤§æ–‡ä»¶ä¸Šä¼  | âœ… å¿…éœ€ |
| `proxy_buffering off` | proxy location | å¤§æ–‡ä»¶æµå¼ä¼ è¾“ | âœ… å¿…éœ€ |
| `expires 30d` | `/models/` location | å¯ç”¨ç¼“å­˜ | â­ æ¨è |
| SSL è¯ä¹¦ | SSL æ ‡ç­¾é¡µ | HTTPS åŠ å¯† | â­ æ¨è |

---

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. **é”™è¯¯æˆªå›¾**ï¼ˆæµè§ˆå™¨æ§åˆ¶å° F12ï¼‰
2. **Nginx é”™è¯¯æ—¥å¿—**ï¼š
   ```bash
   tail -n 50 /www/wwwroot/3dModeldisplay/logs/error.log
   ```
3. **PM2 æ—¥å¿—**ï¼š
   ```bash
   pm2 logs 3d-model-display --lines 50
   ```
4. **curl æµ‹è¯•ç»“æœ**ï¼š
   ```bash
   curl -I -H "Range: bytes=0-1023" http://ä½ çš„IP/models/ä½ çš„æ–‡ä»¶.ply
   ```

---

**ç¥éƒ¨ç½²æˆåŠŸï¼** ğŸ‰

å¦‚æœ‰é—®é¢˜ï¼Œéšæ—¶è”ç³»æˆ‘ã€‚

